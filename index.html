      <strong id="cart-total">0 AOA</strong>
    </div>
    <a class="btn gold" href="carrinho.html" id="finalizar-btn" style="display:none;width:100%;text-align:center">
      Finalizar compra
    </a>
  </div>
</aside>

<footer>
  <div class="wrap">
    <div>
      <strong>Casa Linda Imobiliário, Lda</strong><br>
      <small>Localização: Camama 1</small>
    </div>
    <div class="footer-action">
      <a href="https://wa.me/244932935960" target="_blank">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M20.52 3.48A11.92 11.92 0 0 0 12.01 0C5.38 0 .01 5.37.01 12c0 2.11.55 4.17 1.59 6L0 24l6.12-1.6a11.98 11.98 0 0 0 17.91-10.4c0-3.19-1.24-6.19-3.51-8.52zm-8.51 19.2a9.73 9.73 0 0 1-5.25-1.53l-.38-.23-3.64.95.97-3.55-.25-.37A9.8 9.8 0 1 1 21.82 12a9.8 9.8 0 0 1-9.81 9.68zm5.34-6.97c-.3-.15-1.75-.86-2.02-.95-.27-.1-.47-.15-.66.15-.19.29-.76.95-.93 1.14-.17.19-.34.22-.64.07-.3-.15-1.27-.47-2.42-1.5-.89-.79-1.5-1.77-1.67-2.07-.17-.29-.02-.45.13-.6"/>
        </svg>
        Conversar no WhatsApp
      </a>
    </div>
  </div>
</footer>

<script>
  const CART_KEY = "casaLindaCart";

  function getCart(){ 
    try { return JSON.parse(localStorage.getItem(CART_KEY)) || []; } 
    catch { return []; } 
  }
  function saveCart(cart){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
  function formatCurrency(v){ return new Intl.NumberFormat('pt-AO',{style:'currency',currency:'AOA'}).format(v); }
  function toast(msg){
    const t = document.createElement('div');
    t.className = 'toast'; 
    t.textContent = msg;
    document.body.appendChild(t);
    setTimeout(()=>t.remove(),2000);
  }

  function renderCart(){
    const cart = getCart();
    const body = document.getElementById("drawer-body");
    body.querySelectorAll('.drawer-item').forEach(n => n.remove());
    let total = 0;
    if(cart.length === 0){
      document.getElementById("cart-empty").style.display = 'block';
      document.getElementById("cart-total").textContent = "0 AOA";
      document.getElementById("finalizar-btn").style.display = "none";
    } else {
      document.getElementById("cart-empty").style.display = 'none';
      cart.forEach(i=>{
        total += i.price * i.qty;
        const row = document.createElement("div");
        row.className = "drawer-item";
        row.innerHTML = `
          <div>
            <div class="drawer-item-title">${i.name}</div>
            <div class="drawer-item-meta">${i.variant || '—'} • ${formatCurrency(i.price)}</div>
          </div>
          <div style="display:flex;align-items:center;gap:6px">
            <button class="btn gold" onclick="addMore('${i.id}')">+</button>
            <span><strong>x${i.qty}</strong></span>
            <button class="btn ghost" onclick="removeOne('${i.id}')">-</button>
            <button class="btn ghost" onclick="removeItem('${i.id}')">Remover</button>
          </div>
        `;
        body.appendChild(row);
      });
      document.getElementById("cart-total").textContent = formatCurrency(total);
      document.getElementById("finalizar-btn").style.display = "inline-block";
    }
  }

  function addToCart(item){
    const cart = getCart();
    const idx = cart.findIndex(i => i.id === item.id);
    if(idx>=0){ cart[idx].qty += 1; } else { cart.push({...item, qty:1}); }
    saveCart(cart);
    renderCart();
    toast("Item adicionado ao carrinho.");
    openDrawer(); // abre sempre após inserir o primeiro item
  }

  function removeItem(id){
    const cart = getCart().filter(i => i.id !== id);
    saveCart(cart);
    renderCart();
    toast("Item removido.");
  }

  function addMore(id){
    const cart = getCart();
    const idx = cart.findIndex(i => i.id === id);
    if(idx>=0){ cart[idx].qty += 1; }
    saveCart(cart);
    renderCart();
    toast("Quantidade aumentada.");
  }

  function removeOne(id){
    const cart = getCart();
    const idx = cart.findIndex(i => i.id === id);
    if(idx>=0){ 
      if(cart[idx].qty > 1){ cart[idx].qty -= 1; } else { cart.splice(idx,1); }
    }
    saveCart(cart);
    renderCart();
    toast("Quantidade reduzida.");
  }

  function openDrawer(){
    document.getElementById('drawer').classList.add('open');
    document.getElementById('drawer-overlay').classList.add('active');
  }
  function closeDrawer(){
    document.getElementById('drawer').classList.remove('open');
    document.getElementById('drawer-overlay').classList.remove('active');
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    document.querySelectorAll('[data-add]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const item = {
          id: btn.getAttribute('data-id'),
          name: btn.getAttribute('data-name'),
          variant: btn.getAttribute('data-variant'),
          price: parseFloat(btn.getAttribute('data-price'))
        };
        addToCart(item);
      });
    });

    // botão Carrinho só abre se houver itens
    document.getElementById('open-cart').addEventListener('click', (e)=>{
      e.preventDefault();
      const cart = getCart();
      if(cart.length > 0){
        openDrawer();
      } else {
        toast("Adicione um produto antes de abrir o carrinho.");
      }
    });

    document.getElementById('close-cart').addEventListener('click', ()=> closeDrawer());
    document.getElementById('drawer-overlay').addEventListener('click', closeDrawer);

    renderCart();
  });
</script>
</body>
</html>
